---
keyword: [服务网关, Ingress网关, 云原生网关]
---

# 配置云原生网关

本文介绍如何在MSE上为微服务配置云原生网关。

## 步骤一：新建Ingress网关

1.  登录[MSE网关管理控制台](https://mse.console.aliyun.com/#/microgw)。

2.  在左侧导航栏选择**云原生网关** \> **网关列表**。

3.  在顶部菜单栏选择地域。

4.  在**网关列表**页面左上角单击**创建网关**。

5.  在**创建网关**面板中配置相关参数，然后单击**确定**。

    ![创建Ingress网关](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/0908481261/p275315.png)

    参数说明如下：

    |参数|描述|
    |--|--|
    |**地域**|显示网关地域，不可设置。|
    |**网关名称**|自定义设置网关的名称，推荐用环境（或加业务领域）命名，例如test、order-prod等，最大长度为64个字符。|
    |**网关引擎规格**|根据实际需求选择引擎规格，包括**1核2G**和**2核4G**。|
    |**VPC**|选择后端服务所在的专有网络。|
    |**交换机**|在选择的VPC环境下选择交换机，建议优先选择和后端服务可用区一致的交换机。如果添加多个交换机，可以满足多可用区部署场景。|
    |**公网入口**|选中**公网入口**，选择公网IP地址，可以通过Internet访问。**说明：** 公测期间支持标准型I（slb.s2.small）规格：最大连接数为50000，新建连接速度为5000/秒，QPS支持5000。 |
    |**公网带宽**（网关入口选择公网时设置）|设置公网固定带宽。**说明：** 公测期间支持1MB的公网带宽。 |
    |**私网入口**|选中**私网入口**，选择VPC内的私网IP地址。**说明：** 公测期间支持标准型I（slb.s2.small）规格：最大连接数为50000，新建连接速度为5000/秒，QPS支持5000。 |
    |**网关节点数量**|选择网关的节点数量，生产环境中不建议选择1个节点。**说明：** 公测期间最多可设置3个节点。 |

    **说明：** 网关创建过程可能需要4~5分钟时间，请您耐心等待。


## 步骤二：新建服务来源

1.  在**网关列表**页面，单击目标网关名称或**操作**列下的**管理**。

2.  在**网关详情**页面左侧导航栏单击**服务来源**。

3.  在**服务来源**页面左上角单击**创建来源**。

4.  在**创建来源**面板中配置相关参数，然后单击**确定**。

    ![Ingress创建服务来源](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/5409481261/p275371.png)

    |参数|描述|
    |--|--|
    |**服务来源**|目前仅支持**ACK容器服务**服务来源。**说明：** **MSE Nacos**服务来源暂不支持。 |
    |**ACK集群**|选择后端服务所在的集群。|


## 步骤三：添加服务

**说明：** 建议您从服务来源添加服务，以便网关能够动态获取您的后端服务列表。

1.  在**网关详情**页面左侧导航栏单击**服务管理**。

2.  在**服务管理**页面左上角单击**创建服务**。

3.  在**创建服务**面板中配置服务相关参数，然后单击**确定**。

    ![Ingress网关创建服务](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6587481261/p275386.png)

    参数说明如下：

    |参数|说明|
    |--|--|
    |**服务来源**|选择服务的来源，包含ACK容器服务和固定地址。|
    |当服务来源选择**ACK容器服务-（集群名称）**时，需配置以下参数：|
    |**关联信息**|显示服务关联信息，不可设置。|
    |**命名空间**|选中集群的命名空间。|
    |**服务列表**|在服务列表中选择服务。|
    |当服务来源选择**固定地址**时，需配置以下参数：|
    |**服务名称**|自定义服务名称，仅限字母、数字和下划线（\_），最多64个字符，必须以字母开头。|


## 步骤四：为服务配置路由规则

1.  在**网关详情**页面左侧导航栏单击**路由配置**。

2.  在**路由配置**页面左上角单击**创建路由**。

3.  在**创建路由**面板中配置路由相关参数，然后单击**确定**。

    ![Ingress网关创建路由配置](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/0498234261/p275398.png)

    参数说明如下：

    **说明：**

    -   匹配规则之间是“与”关系，即填写的规则越多匹配的范围越小。
    -   路由之间匹配的优先级与路由配置页面展示排列顺序一致。
    |参数|描述|
    |--|--|
    |**路由名称**|自定义路由名称。|
    |**关联域名**|选择在**域名管理**中创建的域名。|
    |**匹配规则**|
    |**路径（Path）**|设置匹配HTTP请求中的Path参数，相同匹配规则时Path越长优先级越高。包括**前缀匹配**、**精确匹配**和**正则匹配**。    -   前缀匹配：以前缀作为匹配条件，例如Path以/user开头。
    -   精确匹配：即完全匹配，例如Path等于/user。
    -   正则匹配：以正则表达式作为匹配条件。 |
    |**方法（Method）**|设置匹配HTTP请求中的Method参数，不填表示匹配所有参数。|
    |**请求头（Header）**|设置匹配HTTP请求中的Header参数，相同匹配规则时参数越多优先级越高。单击**添加请求头**进行添加。|
    |**请求参数（Query）**|设置匹配HTTP请求中的Query参数，相同匹配规则时参数越多优先级越高。单击**添加请求参数**进行添加。|
    |**目标服务**|选择当前路由的目标服务。|

4.  在**路由配置**页面，在需要发布的路由规则**操作**列单击**发布**。

5.  在确认发布对话框中**确认**。


完成上述步骤后，您就为部署在容器服务ACK中的微服务开启了云原生网关管理。登录[MSE管理控制台](https://mse.console.aliyun.com)，即可使用MSE云原生网关对您的应用进行服务管理，相关内容，请参见[使用指引](/cn.zh-CN/.md)。

